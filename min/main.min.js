var historyEventArr=[],pickIndexToCreateQuestion=function(){var t;do t=_.random(historyEventArr.length);while(historyEventArr[t].attemptedQuestion);return historyEventArr[t].attemptedQuestion=!0,t},today=new Date;Date.prototype.strDateQuery=function(){var t=["January","February","March","April","May","June","July","August","September","October","November","December"],e=today.getMonth();return createWikiEventsScript(t[e]+"%20"+today.getDate())};var HistoryEvent=function(t,e){this.eventStr=t,this.year=e,this.score=4,this.attemptedQuestion=!1};HistoryEvent.prototype.pushToArr=function(){historyEventArr.push(this)},HistoryEvent.prototype.guessYear=function(t){var e=_.random(-3,3)+t,r=0;0>e&&(e=0),e>historyEventArr.length-4&&(e=historyEventArr.length-4);for(var n=e;e+4>n;n++)historyEventArr[n].year===historyEventArr[n+1].year&&r++;e+3+r>=historyEventArr.length&&(e-=r)};var createWikiEventsScript=function(t){return createScriptEl("http://en.wikipedia.org/w/api.php?action=query&prop=revisions&rvprop=content&rvparse=&rvlimit=1&rvsection=1&indexpageids=&titles="+t+"&format=json&callback=getTodaysEvents")},createScriptEl=function(t){return $("<script>").attr("src",t)},getTodaysEvents=function(t){var e=t.query.pageids[0],r=t.query.pages[e].revisions[0]["*"],n=$('<div class="todays-events-container">').html(r);$(".container").append(n),$(n).hide();var o=$(".todays-events-container > ul li");return parseEventsHTMLIntoObjects(o)},parseEventsHTMLIntoObjects=function(t){for(var e=0;e<t.length;e++){for(var r="",n=0;n<t.eq(e).text().length;n++)if(t.eq(e).text().charCodeAt(n)>47&&t.eq(e).text().charCodeAt(n)<58&&(r+=t.eq(e).text().charAt(n),!(t.eq(e).text().charCodeAt(n+1)>47&&t.eq(e).text().charCodeAt(n+1)<58))){if("B"==t.eq(e).text().charAt(n+2)&&"C"==t.eq(e).text().charAt(n+3)){r+=" BC";break}break}var o=t.eq(e).text().slice(r.length+3),a=new HistoryEvent(o,r);a.pushToArr()}};$(document).on("ready",function(){$("body").append(today.strDateQuery())});